## 横天8.26-8.30 周报

### 概览  
* 上线日常/项目: 1 
* 进行中的日常/项目: 2

### 本周  
* 周一下午去1688响应式评选活动  
* 网厅回归上线发布  
* 周期购订单列表页面的取消周期弹出层  
   * 完成了弹出层的demo版本  
   * 因为页面要求更改为iframe版本，我负责iframe页面的相关操作  
* 周期购物订单详情页面  
   * 继续与@花潭一起连调  
   * 完成相关接口的测试  
*  猜代码ppt演示  
   * 从impress.js换成reveal.js  

## 下周工作计划  
* 周期购  
* KHC（暂未确定）  

## 心得  
*  这周在做wt回归发布的时候，发布匆忙，在未进行代码的review之前就进行发布， 
   差一点造成ie6下面的线上bug， 幸好及时发现问题。 总结， 在每次进行代码提交  
   之前都要进行jslint 检测以及review代码， 避免低级错误发生。


--------
--------


##横天9.2-9.6周报告


###概览  
* 上线日常/项目: 0  
* 进行中的日常/项目: 3  

###本周  
* 周期购物取消周期弹层  
   * 与开发一起联调  
   * 增加提示成功错误iframe页面  
* 周期购订单详情提测  
   * 本周3提测  
   * 解决测试提出的一些bug  
* 订单详情页整合optimize  
   * 因为optimize优化一部分需要后台支持， 暂时只更改了无需后台支持的部分  
* 适合交易的jsTracker部署[#5572](http://work.tmall.net/issues/5572)  
* 狂欢城 [#5224](work.tmall.net/arklogin?path=http://work.tmall.net/issues/5224)  
   * 研究2d物理引擎box2d-js，verlet-js。  
   * 非物理引擎实现方案的OBB碰撞算法以及GJK算法的学习。  

## 下周计划  
* 订单详情  
* 狂欢城  

## 心得  
*  尽管对于前端来说， 算法部分显得不是那么重要， 但是当遇到性能瓶颈的时候， 特别是对于前端游戏开发来说，没有一定算法基础， 很难突破， 所以在空余时间多学习了解算法会很有帮助。 弥补自己的不足。    

###概览 
* 上线日常/项目: 0  
* 进行中的日常/项目：1  

###详细  
* 互动城游戏开发  
  *  中秋前到现在一直都在做互动城的游戏开发， 从游戏框架底层到上层的业务开发 
  *  中秋前主要的工作是做游戏资源管理resoureManager模块以及底层优化
  *  中秋加班完成kissme demo版本开发  
  *  这周的主要工作是互动城市主场景开发 - http://work.tmall.net/issues/6161  
  *  风险：因为设计的进度原因， 导致游戏开发进度部分受阻， 并且主场景中又部分交互还没有确定， 无法预估完成时间。  

## 下周工作  
* 互动城  

## 心得  
*  因为新同学墨川的到来， 游戏开发相对较轻松多了！ 遇到相关问题， 也有可以讨论的对象。
* 

###概览 
* 上线日常/项目: 0  
* 进行中的日常/项目：1  

###详细  
* 互动城游戏开发  
  - 添加4个业务入口以及其动画效果  
  - 主场景的优化， 修改元素创建逻辑， 图片优化压缩合并  
  - tip位置自适应  
  - 加载优化， 调整资源包， 一环小人实现先静态加载  
  - 主场景动画优化   
    - 对于粒子效果的通过particleSystem来实现 
    - Anim扩展增加缓存pool，使原先的平均3000个左右的Anim对象变成平均20个Anim对象 
    - 去除setimeout逻辑， 发现大量创建setimeout会对性能有很大的影响， 通过tickle时钟来实现delay方法   

## 下周工作  
* 互动城  

## 心得  
*  其实游戏本身的开发不是难点， 难点在于如何做到性能上的最优和可交互时间的最短。   



###概览 
* 上线日常/项目: 0  
* 进行中的日常/项目：1  

###详细  
* 互动城游戏开发
  - 解决狂欢城兼容问题[#6959](http://work.tmall.net/issues/6959)  
  - 游戏性能优化  
    * 对游戏资源的大小，尺寸的优化  
    * flashcanvas ie下的卡顿问题  
    * 框架部分的部分函数方法优化  
    * 设置降级开关  
  - 主场景新添加的业务  
    * 小人hover的动画效果  
    * 品牌浮层的自适应位置调整  
    * 小人动画随机策略   
  - ui部分ie7兼容   


## 下周工作  
* 互动城  
  

非常抱歉， 发现周报没有顺利发出， 补发！
###概览 
* 上线日常/项目: 1  
* 进行中的日常/项目：1  

###详细  
* 互动城上线  
* 本周工作  
   * 更换游戏加载进度条  
   * ie6 提示升级页面  
   * 主场景添加双十一之歌  
   * 完善补充业务埋点  
   * 主场景喵喵神帽子精灵     

##下周工作  
* 互动城值班  

##感想  
  怀着忐忑的心情， 互动城终于上线了，#鼓掌# , 最大的遗憾是我中的红包好少-_-! 。

   



##狂欢城前端个人总结  

     
  * 概览  
       经过一两个月的奋战， 狂欢城顺利上线，就其中在技术上有可圈点的地方， 也有不足的地方。这次的狂欢城项目对于高级浏览器是使用纯canvas来实现，在天猫或者说淘宝历史上算是首创。 同时也做到兼容低级浏览器ie7，8。 虽然mobile版本不是由我们来做，我们也做出了兼容mobile版本的demo。    
  * 性能  
      做游戏开发最大的问题就是性能优化部分， 如果只是做到在chrome下面顺畅运行， 那再简单不过了， 狂欢城项目需要兼容几乎所有的浏览器， 如何在ie7，8上面都能够顺畅运行， 这是这次开发的难点。  我们的工作是利用各种性能优化技巧来优化程序的运行， 提高fps， 这些技术包括使用对象缓存pool， 使用统一的时钟管理所有的delay function， canvas api调用优化 等等。 因为低级浏览器是使用flashcanvas来实现的， 在使用过程中会遇到各样的问题， 诸如白屏， 闪动， 跨域， 图片重加载等等，所以我们的另一部分优化工作就是在优化flashcanvas， 通过更改flashcanvas源码来实现我们自己的需求。  
  * 加载  
      与普通的游戏不同， 对于网页游戏， 资源加载是一大命题。 如何缩短可交互时间是这才狂欢城的一大挑战。 对于主场景来说， 所以的小人资源加起来可以到达20M, 通过我们对图片资源的调整压缩， 最终将资源降低到10M左右。 但是永远不可能让用户等待加载10M的东西。   为了缩短可交互时间， 我们做了场景地图切分， 小人分为静态和动态， 资源加载队列式管理， 加载容错处理， 加载策略配置， 合成图片精灵等等。 最终， 我们的首屏资源大小在300K左右。  以用户180Kb的平均网速， 加上脚本资源， 用户的平均加载时间应该在3秒左右。   
  * 设计  
      不同于其他开发， 互动营销类的开发最大的特点就是不断的变化， 如果没有好的代码设计， 一有变动， 那是伤心又伤身。  拿我们这才的开发来说， 场景中的小人会不断的变动， 包括位置的变动， 形象的变动， 动作的变动。 场景中的地图会不断的变动， 场景中的物体也会不断的变动， 如何让代码能够快速响应这些变动已经是一种隐性需求。  在我们的的设计中， 对于新添加物体， 只需要在资源保重配置好路径， 在config中配置好位置属性。 对于位置的大量更改， 所有的物体都是可拖拽的， 运营可以按照自己的想法拖拽的方式定位小人， 将打印出的配置给我就可以响应大量位置更改需求。  
  * 感想  
     作为实习生的我， 能够做狂欢城这么大的项目， 是我的一种骄傲， 不管加班有多辛苦都是值得的！  


  

